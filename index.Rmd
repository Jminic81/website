---
title: "dplyr"
output: html_document
---
![](MyPic.jpg)

### Filtering Columns and Rows

When using dplyr, you can filter columns and rows by using select and filter.  Let's look at an example using the Lahman baseball database. We first have to load the Lahman and dplyr packages.

```{r message=FALSE, warning=FALSE}
library(Lahman)
library(dplyr)
```

Now suppose we would like to see the homerun totals for the 1927 New York Yankees.  We could run the following code:

```{r}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(teamID=='NYA'& yearID==1927)
```

#Show all instances where Yankees hit 40+ HRs

```{r}
Batting%>%
  filter(HR>=40 & teamID=='NYA')%>%
  select(playerID,yearID,teamID,HR)
```

#Show all instances where Yankees hit >40 HRs but <60 Strikeouts

```{r}
Batting%>%
  select(playerID,yearID, teamID,HR,SO)%>%
  filter(HR>40 & SO>60)
```

#Show all instances where players hit >50 in descending order.  The default is ascending order.

```{r}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(HR>50)%>%
  arrange(desc(HR)) 
```

#Show all instances of a player striking out less than 10 times and more than 400 at bats.

```{r}
Batting%>%
  select(playerID,yearID,teamID,SO, AB)%>%
  filter(SO<10 & AB>=400)%>%
  arrange(SO)
```

#Show all instances of a Philly player with >30 HRs between years 1970 and 1979

```{r}
Batting%>%
  select(playerID,yearID,teamID,HR)%>%
  filter(teamID=='PHI' & HR>30 & yearID<=1979 & yearID>=1970)
```

#Show the number of career homeruns by Babe Ruth.

```{r}
Batting%>%
  filter(playerID=='ruthba01')%>%
  group_by(playerID)%>%
  summarize(career_HR=sum(HR)) 
```

###Arranging 

##Results can be displayed in ascending or descending order.  The default is ascending order.

#Example 1

Show the players that have had greater than or equal to 600 career homeruns in descending order.

```{r}
Batting%>%
  group_by(playerID)%>%
  summarize(career_HR=sum(HR))%>%
  filter(career_HR>='600')%>%
  arrange(desc(career_HR))
```

#Example 2

Show the players that have had greater than 30 average homerun season totals in descending order.

```{r}
Batting%>%
  group_by(playerID)%>%
  summarize(HRAvg=mean(HR))%>%
  filter(HRAvg>30)%>%
  arrange(desc(HRAvg))
```

#Example 3

#Which players since 1970 have hit more than 50 homeruns at least once?

```{r}
Batting%>%
  filter(yearID>=1970)%>%
  group_by(playerID)%>%
  summarize(maxHR=max(HR))%>%
  filter(maxHR>50)%>%
  select(playerID)
```

